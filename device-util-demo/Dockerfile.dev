# Development Dockerfile with Hot Reload Support
FROM maven:3.8.6-openjdk-8-slim

# Set working directory
WORKDIR /app

# Copy pom files
COPY pom.xml .
COPY utils-common/pom.xml ./utils-common/
COPY brezze-communication/pom.xml ./brezze-communication/

# Download dependencies (cached layer)
RUN mvn dependency:go-offline -B || true

# Copy source code (will be overridden by volume mount in dev mode)
COPY utils-common/src ./utils-common/src
COPY brezze-communication/src ./brezze-communication/src

# Expose port
EXPOSE 10030

# Use spring-boot:run for hot reload
CMD ["mvn", "spring-boot:run", "-pl", "brezze-communication", "-Dspring-boot.run.profiles=docker"]
